package(default_visibility = ["//visibility:public"])

load("//tools:ts_library.bzl", "ts_library")

ts_library(
    name = "api",
    srcs = glob(
        ["**/*.ts"],
        exclude = ["utils/**/*.*"],
    ),
    data = [
        "@nodejs_linux_amd64//:node_bin",
        "//sandbox:compile_executor",
        "//sandbox/worker:worker_bundle.js",
        "//sandbox/worker:node_modules"
    ],
    deps = [
        "//api/utils",
        "//common/errors",
        "//common/flags",
        "//common/promises",
        "//common/protos",
        "//common/strings",
        "//core",
        "//protos:ts",
        "//sandbox/vm:compile_loader",
        "//sqlx",
        "//sandbox/vm:vm",
        "@npm//@google-cloud/bigquery",
        "@npm//@types/glob",
        "@npm//@types/js-beautify",
        "@npm//@types/lodash",
        "@npm//@types/long",
        "@npm//@types/mssql",
        "@npm//@types/node",
        "@npm//@types/object-hash",
        "@npm//@types/pg",
        "@npm//@types/pg-query-stream",
        "@npm//@types/semver",
        "@npm//@types/ssh2",
        "@npm//@types/uuid",
        "@npm//cron-parser",
        "@npm//deepmerge",
        "@npm//get-port",
        "@npm//glob",
        "@npm//js-beautify",
        "@npm//lodash",
        "@npm//mssql",
        "@npm//object-hash",
        "@npm//pg",
        "@npm//uuid",
        "@npm//pg-query-stream",
        "@npm//presto-client",
        "@npm//pretty-ms",
        "@npm//promise-pool-executor",
        "@npm//protobufjs",
        "@npm//semver",
        "@npm//snowflake-sdk",
        "@npm//sql-formatter",
        "@npm//ssh2",
    ],
)
